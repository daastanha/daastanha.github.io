<!DOCTYPE html>
<html>
<head>
    <title>Editable Table</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>
    <div class="container">
        <h2>Book List</h2>
        <input type="text" id="searchInput" onkeyup="searchFunction()" placeholder="Search for books..">
        <table class="table" id="bookTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Author</th>
                    <th>Language</th>
                    <th>Date (started)</th>
                    <th>Notes</th>
                    <th>Date (finished)</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <script>
        var sortAscending = true;
        var table = d3.select('#bookTable');
        var tbody = table.select('tbody');
        var columns = ["Name", "Author", "Language", "Date(started)", "Notes", "Date(finished)"];

        d3.csv("data.csv").then(function(data) {
            data.forEach(function(d) {
                var row = tbody.append("tr");
                columns.forEach(function(column) {
                    row.append("td").text(d[column]);
                });
            });

            table.selectAll('th')
                .data(columns)
                .enter()
                .append('th')
                .text(function (d) { return d; })
                .on('click', function (d) {
                    if (sortAscending) {
                        rows.sort(function(a, b) { return d3.ascending(a[d], b[d]); });
                        sortAscending = false;
                    } else {
                        rows.sort(function(a, b) { return d3.descending(a[d], b[d]); });
                        sortAscending = true;
                    }
                });
        });

        function searchFunction() {
            var input, filter, tr, td, i, txtValue;
            input = document.getElementById("searchInput");
            filter = input.value.toUpperCase();
            tr = tbody.selectAll("tr");
            tr.each(function() {
                td = d3.select(this).selectAll("td").nodes()[0];
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        d3.select(this).style("display", "");
                    } else {
                        d3.select(this).style("display", "none");
                    }
                }       
            });
        }
    </script>
</body>
</html>
